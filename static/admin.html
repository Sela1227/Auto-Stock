<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç®¡ç†å¾Œå° - SELA è‡ªå‹•é¸è‚¡ç³»çµ±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" type="image/png" href="/static/logo.png">
    <style>
        .brand-orange { color: #FA7A35; }
        .bg-brand-orange { background-color: #FA7A35; }
        .hover\:bg-brand-orange-dark:hover { background-color: #e56a25; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <!-- é ‚éƒ¨å°èˆª -->
    <nav class="bg-slate-800 text-white shadow-lg">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-4">
                    <span class="text-xl font-bold bg-brand-orange px-3 py-1 rounded">SELA</span>
                    <span class="text-lg">ç®¡ç†å¾Œå°</span>
                </div>
                <div class="flex items-center space-x-4">
                    <a href="/static/dashboard.html" class="text-gray-300 hover:text-white">
                        â† è¿”å›å„€è¡¨æ¿
                    </a>
                    <span id="adminName" class="text-gray-300"></span>
                </div>
            </div>
        </div>
    </nav>

    <!-- ä¸»å…§å®¹ -->
    <div class="max-w-7xl mx-auto px-4 py-6">
        <!-- çµ±è¨ˆå¡ç‰‡ -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
            <div class="bg-white rounded-lg shadow p-4">
                <div class="text-gray-500 text-sm">ç¸½ç”¨æˆ¶æ•¸</div>
                <div id="statTotal" class="text-2xl font-bold text-slate-800">-</div>
            </div>
            <div class="bg-white rounded-lg shadow p-4">
                <div class="text-gray-500 text-sm">ä»Šæ—¥ç™»å…¥</div>
                <div id="statToday" class="text-2xl font-bold text-green-600">-</div>
            </div>
            <div class="bg-white rounded-lg shadow p-4">
                <div class="text-gray-500 text-sm">å°é–ç”¨æˆ¶</div>
                <div id="statBlocked" class="text-2xl font-bold text-red-600">-</div>
            </div>
            <div class="bg-white rounded-lg shadow p-4">
                <div class="text-gray-500 text-sm">ç®¡ç†å“¡</div>
                <div id="statAdmin" class="text-2xl font-bold text-blue-600">-</div>
            </div>
        </div>
        
        <!-- ç³»çµ±ç®¡ç† -->
        <div class="bg-white rounded-lg shadow p-4 mb-6">
            <h3 class="font-bold text-gray-700 mb-4">ğŸ“Š å¸‚å ´è³‡æ–™ç®¡ç†</h3>
            <div class="flex flex-wrap gap-3">
                <button onclick="initializeData()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center">
                    <span class="mr-2">ğŸ”„</span>åˆå§‹åŒ–æ­·å²è³‡æ–™
                </button>
                <button onclick="updateIndices()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center">
                    <span class="mr-2">ğŸ“ˆ</span>æ›´æ–°ä¸‰å¤§æŒ‡æ•¸
                </button>
                <button onclick="updateSentiment()" class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 flex items-center">
                    <span class="mr-2">ğŸ’­</span>æ›´æ–°ææ‡¼è²ªå©ª
                </button>
                <button onclick="triggerDailyUpdate()" class="bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700 flex items-center">
                    <span class="mr-2">âš¡</span>åŸ·è¡Œæ¯æ—¥æ›´æ–°
                </button>
            </div>
            <p id="systemMessage" class="mt-3 text-sm text-gray-500"></p>
        </div>

        <!-- æœå°‹å’Œç¯©é¸ -->
        <div class="bg-white rounded-lg shadow p-4 mb-6">
            <div class="flex flex-col md:flex-row gap-4">
                <div class="flex-1">
                    <input type="text" id="searchInput" placeholder="æœå°‹ç”¨æˆ¶åç¨±ã€Email æˆ– LINE ID..."
                        class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-400">
                </div>
                <div class="flex gap-2">
                    <label class="flex items-center">
                        <input type="checkbox" id="blockedOnly" class="mr-2">
                        <span class="text-sm">åªé¡¯ç¤ºå°é–</span>
                    </label>
                    <button onclick="loadUsers()" class="bg-brand-orange text-white px-4 py-2 rounded-lg hover:bg-brand-orange-dark">
                        æœå°‹
                    </button>
                    <button onclick="kickAllUsers()" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700">
                        è¸¢å‡ºå…¨éƒ¨
                    </button>
                </div>
            </div>
        </div>

        <!-- ç”¨æˆ¶åˆ—è¡¨ -->
        <div class="bg-white rounded-lg shadow overflow-hidden">
            <div class="overflow-x-auto">
                <table class="w-full">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">ç”¨æˆ¶</th>
                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase hidden md:table-cell">Email</th>
                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">ç‹€æ…‹</th>
                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase hidden md:table-cell">æœ€å¾Œç™»å…¥</th>
                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody id="userList" class="divide-y divide-gray-200">
                        <!-- å‹•æ…‹è¼‰å…¥ -->
                    </tbody>
                </table>
            </div>
            
            <!-- åˆ†é  -->
            <div class="px-4 py-3 bg-gray-50 flex items-center justify-between">
                <div id="pageInfo" class="text-sm text-gray-500"></div>
                <div class="flex gap-2">
                    <button id="prevPage" onclick="changePage(-1)" class="px-3 py-1 border rounded hover:bg-gray-100" disabled>ä¸Šä¸€é </button>
                    <button id="nextPage" onclick="changePage(1)" class="px-3 py-1 border rounded hover:bg-gray-100" disabled>ä¸‹ä¸€é </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ç”¨æˆ¶è©³æƒ… Modal -->
    <div id="userModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-bold">ç”¨æˆ¶è©³æƒ…</h3>
                    <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700">âœ•</button>
                </div>
                <div id="modalContent">
                    <!-- å‹•æ…‹è¼‰å…¥ -->
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentPage = 1;
        let totalPages = 1;
        const token = localStorage.getItem('token');
        const user = JSON.parse(localStorage.getItem('user') || '{}');

        // æª¢æŸ¥ç™»å…¥å’Œç®¡ç†å“¡æ¬Šé™
        if (!token) {
            window.location.href = '/static/index.html';
        }

        document.getElementById('adminName').textContent = user.display_name || '';

        // API è«‹æ±‚
        async function apiRequest(url, options = {}) {
            const response = await fetch(url, {
                ...options,
                headers: {
                    'Authorization': `Bearer ${token}`,
                    'Content-Type': 'application/json',
                    ...options.headers
                }
            });
            
            if (response.status === 401) {
                localStorage.clear();
                window.location.href = '/static/index.html';
                return null;
            }
            
            if (response.status === 403) {
                alert('æ‚¨æ²’æœ‰ç®¡ç†å“¡æ¬Šé™');
                window.location.href = '/static/dashboard.html';
                return null;
            }
            
            return response.json();
        }

        // è¼‰å…¥çµ±è¨ˆ
        async function loadStats() {
            const data = await apiRequest('/api/admin/stats');
            if (data && data.success) {
                document.getElementById('statTotal').textContent = data.stats.total_users;
                document.getElementById('statToday').textContent = data.stats.today_logins;
                document.getElementById('statBlocked').textContent = data.stats.blocked_users;
                document.getElementById('statAdmin').textContent = data.stats.admin_users;
            }
        }

        // è¼‰å…¥ç”¨æˆ¶åˆ—è¡¨
        async function loadUsers() {
            const search = document.getElementById('searchInput').value;
            const blockedOnly = document.getElementById('blockedOnly').checked;
            
            let url = `/api/admin/users?page=${currentPage}&page_size=20`;
            if (search) url += `&search=${encodeURIComponent(search)}`;
            if (blockedOnly) url += `&blocked_only=true`;
            
            const data = await apiRequest(url);
            if (data && data.success) {
                renderUsers(data.users);
                totalPages = data.pagination.total_pages;
                document.getElementById('pageInfo').textContent = 
                    `ç¬¬ ${data.pagination.page} / ${totalPages} é ï¼Œå…± ${data.pagination.total} ç­†`;
                document.getElementById('prevPage').disabled = currentPage <= 1;
                document.getElementById('nextPage').disabled = currentPage >= totalPages;
            }
        }

        // æ¸²æŸ“ç”¨æˆ¶åˆ—è¡¨
        function renderUsers(users) {
            const tbody = document.getElementById('userList');
            tbody.innerHTML = users.map(u => `
                <tr class="hover:bg-gray-50">
                    <td class="px-4 py-3">
                        <div class="flex items-center">
                            <img src="${u.picture_url || '/static/logo.png'}" 
                                class="w-10 h-10 rounded-full mr-3" 
                                onerror="this.src='/static/logo.png'">
                            <div>
                                <div class="font-medium text-gray-900">${escapeHtml(u.display_name || 'æœªå‘½å')}</div>
                                <div class="text-xs text-gray-500">ID: ${u.id}</div>
                            </div>
                        </div>
                    </td>
                    <td class="px-4 py-3 text-sm text-gray-500 hidden md:table-cell">
                        ${escapeHtml(u.email || '-')}
                    </td>
                    <td class="px-4 py-3">
                        <div class="flex flex-wrap gap-1">
                            ${u.is_admin ? '<span class="px-2 py-0.5 text-xs rounded-full bg-blue-100 text-blue-800">ç®¡ç†å“¡</span>' : ''}
                            ${u.is_blocked ? '<span class="px-2 py-0.5 text-xs rounded-full bg-red-100 text-red-800">å·²å°é–</span>' : '<span class="px-2 py-0.5 text-xs rounded-full bg-green-100 text-green-800">æ­£å¸¸</span>'}
                        </div>
                    </td>
                    <td class="px-4 py-3 text-sm text-gray-500 hidden md:table-cell">
                        ${formatDate(u.last_login)}
                    </td>
                    <td class="px-4 py-3">
                        <div class="flex gap-1">
                            <button onclick="showUserDetail(${u.id})" 
                                class="px-2 py-1 text-xs bg-gray-100 hover:bg-gray-200 rounded">è©³æƒ…</button>
                            ${u.is_blocked 
                                ? `<button onclick="unblockUser(${u.id})" class="px-2 py-1 text-xs bg-green-100 hover:bg-green-200 text-green-700 rounded">è§£å°</button>`
                                : `<button onclick="blockUser(${u.id})" class="px-2 py-1 text-xs bg-red-100 hover:bg-red-200 text-red-700 rounded">å°é–</button>`
                            }
                            <button onclick="kickUser(${u.id})" 
                                class="px-2 py-1 text-xs bg-yellow-100 hover:bg-yellow-200 text-yellow-700 rounded">è¸¢å‡º</button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        // é¡¯ç¤ºç”¨æˆ¶è©³æƒ…
        async function showUserDetail(userId) {
            const data = await apiRequest(`/api/admin/users/${userId}`);
            if (data && data.success) {
                const u = data.user;
                const logs = data.recent_logs;
                
                document.getElementById('modalContent').innerHTML = `
                    <div class="flex items-center mb-4">
                        <img src="${u.picture_url || '/static/logo.png'}" 
                            class="w-16 h-16 rounded-full mr-4"
                            onerror="this.src='/static/logo.png'">
                        <div>
                            <div class="font-bold text-xl">${escapeHtml(u.display_name || 'æœªå‘½å')}</div>
                            <div class="text-gray-500">${escapeHtml(u.email || 'ç„¡ Email')}</div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <div class="bg-gray-50 p-3 rounded">
                            <div class="text-xs text-gray-500">ç”¨æˆ¶ ID</div>
                            <div class="font-medium">${u.id}</div>
                        </div>
                        <div class="bg-gray-50 p-3 rounded">
                            <div class="text-xs text-gray-500">LINE ID</div>
                            <div class="font-medium text-xs break-all">${u.line_user_id}</div>
                        </div>
                        <div class="bg-gray-50 p-3 rounded">
                            <div class="text-xs text-gray-500">è¨»å†Šæ™‚é–“</div>
                            <div class="font-medium">${formatDate(u.created_at)}</div>
                        </div>
                        <div class="bg-gray-50 p-3 rounded">
                            <div class="text-xs text-gray-500">æœ€å¾Œç™»å…¥</div>
                            <div class="font-medium">${formatDate(u.last_login)}</div>
                        </div>
                    </div>
                    
                    <div class="flex gap-2 mb-4">
                        ${u.is_admin 
                            ? `<button onclick="removeAdmin(${u.id})" class="flex-1 py-2 bg-gray-200 hover:bg-gray-300 rounded">ç§»é™¤ç®¡ç†å“¡</button>`
                            : `<button onclick="setAdmin(${u.id})" class="flex-1 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded">è¨­ç‚ºç®¡ç†å“¡</button>`
                        }
                        ${u.is_blocked 
                            ? `<button onclick="unblockUser(${u.id})" class="flex-1 py-2 bg-green-500 hover:bg-green-600 text-white rounded">è§£é™¤å°é–</button>`
                            : `<button onclick="blockUser(${u.id})" class="flex-1 py-2 bg-red-500 hover:bg-red-600 text-white rounded">å°é–ç”¨æˆ¶</button>`
                        }
                    </div>
                    
                    ${u.is_blocked ? `
                        <div class="bg-red-50 p-3 rounded mb-4">
                            <div class="text-red-800 font-medium">å°é–è³‡è¨Š</div>
                            <div class="text-sm text-red-600">åŸå› ï¼š${escapeHtml(u.blocked_reason || 'æœªèªªæ˜')}</div>
                            <div class="text-sm text-red-600">æ™‚é–“ï¼š${formatDate(u.blocked_at)}</div>
                        </div>
                    ` : ''}
                    
                    <div class="border-t pt-4">
                        <div class="font-medium mb-2">æœ€è¿‘æ´»å‹•è¨˜éŒ„</div>
                        <div class="max-h-48 overflow-y-auto">
                            ${logs.length ? logs.map(log => `
                                <div class="flex justify-between py-1 text-sm border-b">
                                    <span class="text-gray-600">${getActionText(log.action)}</span>
                                    <span class="text-gray-400">${formatDate(log.created_at)}</span>
                                </div>
                            `).join('') : '<div class="text-gray-400 text-sm">ç„¡è¨˜éŒ„</div>'}
                        </div>
                    </div>
                `;
                
                document.getElementById('userModal').classList.remove('hidden');
                document.getElementById('userModal').classList.add('flex');
            }
        }

        function closeModal() {
            document.getElementById('userModal').classList.add('hidden');
            document.getElementById('userModal').classList.remove('flex');
        }

        // æ“ä½œå‡½æ•¸
        async function blockUser(userId) {
            const reason = prompt('è«‹è¼¸å…¥å°é–åŸå› ï¼ˆå¯ç•™ç©ºï¼‰ï¼š');
            if (reason === null) return;
            
            const data = await apiRequest(`/api/admin/users/${userId}/block?reason=${encodeURIComponent(reason)}`, {
                method: 'POST'
            });
            if (data && data.success) {
                alert(data.message);
                loadUsers();
                loadStats();
                closeModal();
            }
        }

        async function unblockUser(userId) {
            if (!confirm('ç¢ºå®šè¦è§£é™¤å°é–æ­¤ç”¨æˆ¶å—ï¼Ÿ')) return;
            
            const data = await apiRequest(`/api/admin/users/${userId}/unblock`, {
                method: 'POST'
            });
            if (data && data.success) {
                alert(data.message);
                loadUsers();
                loadStats();
                closeModal();
            }
        }

        async function kickUser(userId) {
            if (!confirm('ç¢ºå®šè¦è¸¢å‡ºæ­¤ç”¨æˆ¶å—ï¼Ÿç”¨æˆ¶éœ€è¦é‡æ–°ç™»å…¥ã€‚')) return;
            
            const data = await apiRequest(`/api/admin/users/${userId}/kick`, {
                method: 'POST'
            });
            if (data && data.success) {
                alert(data.message);
            }
        }

        async function kickAllUsers() {
            if (!confirm('âš ï¸ ç¢ºå®šè¦è¸¢å‡ºæ‰€æœ‰ç”¨æˆ¶å—ï¼Ÿæ‰€æœ‰äººï¼ˆåŒ…æ‹¬æ‚¨è‡ªå·±ï¼‰éƒ½éœ€è¦é‡æ–°ç™»å…¥ï¼')) return;
            if (!confirm('å†æ¬¡ç¢ºèªï¼šé€™å°‡ä½¿æ‰€æœ‰ç™»å…¥ Token å¤±æ•ˆï¼')) return;
            
            const data = await apiRequest('/api/admin/kick-all', {
                method: 'POST'
            });
            if (data && data.success) {
                alert(data.message);
                localStorage.clear();
                window.location.href = '/static/index.html';
            }
        }

        async function setAdmin(userId) {
            if (!confirm('ç¢ºå®šè¦å°‡æ­¤ç”¨æˆ¶è¨­ç‚ºç®¡ç†å“¡å—ï¼Ÿ')) return;
            
            const data = await apiRequest(`/api/admin/users/${userId}/set-admin`, {
                method: 'POST'
            });
            if (data && data.success) {
                alert(data.message);
                loadUsers();
                loadStats();
                closeModal();
            }
        }

        async function removeAdmin(userId) {
            if (!confirm('ç¢ºå®šè¦ç§»é™¤æ­¤ç”¨æˆ¶çš„ç®¡ç†å“¡æ¬Šé™å—ï¼Ÿ')) return;
            
            const data = await apiRequest(`/api/admin/users/${userId}/remove-admin`, {
                method: 'POST'
            });
            if (data && data.success) {
                alert(data.message);
                loadUsers();
                loadStats();
                closeModal();
            }
        }

        function changePage(delta) {
            currentPage += delta;
            loadUsers();
        }

        // å·¥å…·å‡½æ•¸
        function escapeHtml(text) {
            if (!text) return '';
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function formatDate(dateStr) {
            if (!dateStr) return '-';
            const date = new Date(dateStr);
            return date.toLocaleString('zh-TW', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        function getActionText(action) {
            const actions = {
                'login': 'ğŸ”‘ ç™»å…¥',
                'logout': 'ğŸšª ç™»å‡º',
                'blocked': 'ğŸš« è¢«å°é–',
                'unblocked': 'âœ… è§£é™¤å°é–',
                'kicked': 'ğŸ‘¢ è¢«è¸¢å‡º',
                'kick_all': 'ğŸ‘¢ å…¨å“¡è¸¢å‡º',
            };
            return actions[action] || action;
        }
        
        // ===== å¸‚å ´è³‡æ–™ç®¡ç† =====
        
        function showSystemMessage(msg, isError = false) {
            const el = document.getElementById('systemMessage');
            el.textContent = msg;
            el.className = `mt-3 text-sm ${isError ? 'text-red-600' : 'text-green-600'}`;
        }
        
        async function initializeData() {
            if (!confirm('é€™æœƒåˆå§‹åŒ–ä¸‰å¤§æŒ‡æ•¸æ­·å²è³‡æ–™ï¼ˆ10å¹´ï¼‰å’Œå¹£åœˆæƒ…ç·’æ­·å²ï¼ˆ365å¤©ï¼‰ï¼Œå¯èƒ½éœ€è¦å¹¾åˆ†é˜ã€‚ç¢ºå®šè¦åŸ·è¡Œå—ï¼Ÿ')) {
                return;
            }
            
            showSystemMessage('æ­£åœ¨åˆå§‹åŒ–è³‡æ–™ï¼Œè«‹ç¨å€™...');
            
            try {
                const data = await apiRequest('/api/market/admin/initialize', { method: 'POST' });
                if (data && data.success) {
                    showSystemMessage(`âœ… åˆå§‹åŒ–å®Œæˆï¼æŒ‡æ•¸: ${data.data?.indices || 0} ç­†, æƒ…ç·’: ${data.data?.sentiment || 0} ç­†`);
                } else {
                    showSystemMessage(`âŒ åˆå§‹åŒ–å¤±æ•—: ${data?.detail || 'æœªçŸ¥éŒ¯èª¤'}`, true);
                }
            } catch (e) {
                showSystemMessage(`âŒ åˆå§‹åŒ–å¤±æ•—: ${e.message}`, true);
            }
        }
        
        async function updateIndices() {
            showSystemMessage('æ­£åœ¨æ›´æ–°ä¸‰å¤§æŒ‡æ•¸...');
            
            try {
                const data = await apiRequest('/api/market/admin/update-indices', { method: 'POST' });
                if (data && data.success) {
                    showSystemMessage(`âœ… ä¸‰å¤§æŒ‡æ•¸æ›´æ–°å®Œæˆï¼${data.data?.count || 0} ç­†è³‡æ–™`);
                } else {
                    showSystemMessage(`âŒ æ›´æ–°å¤±æ•—: ${data?.detail || 'æœªçŸ¥éŒ¯èª¤'}`, true);
                }
            } catch (e) {
                showSystemMessage(`âŒ æ›´æ–°å¤±æ•—: ${e.message}`, true);
            }
        }
        
        async function updateSentiment() {
            showSystemMessage('æ­£åœ¨æ›´æ–°ææ‡¼è²ªå©ªæŒ‡æ•¸...');
            
            try {
                const data = await apiRequest('/api/market/admin/update-sentiment', { method: 'POST' });
                if (data && data.success) {
                    showSystemMessage(`âœ… ææ‡¼è²ªå©ªæŒ‡æ•¸æ›´æ–°å®Œæˆï¼`);
                } else {
                    showSystemMessage(`âŒ æ›´æ–°å¤±æ•—: ${data?.detail || 'æœªçŸ¥éŒ¯èª¤'}`, true);
                }
            } catch (e) {
                showSystemMessage(`âŒ æ›´æ–°å¤±æ•—: ${e.message}`, true);
            }
        }
        
        async function triggerDailyUpdate() {
            showSystemMessage('æ­£åœ¨åŸ·è¡Œæ¯æ—¥æ›´æ–°...');
            
            try {
                const data = await apiRequest('/api/market/admin/update', { method: 'POST' });
                if (data && data.success) {
                    showSystemMessage(`âœ… æ¯æ—¥æ›´æ–°å®Œæˆï¼`);
                } else {
                    showSystemMessage(`âŒ æ›´æ–°å¤±æ•—: ${data?.detail || 'æœªçŸ¥éŒ¯èª¤'}`, true);
                }
            } catch (e) {
                showSystemMessage(`âŒ æ›´æ–°å¤±æ•—: ${e.message}`, true);
            }
        }

        // æœå°‹ Enter éµæ”¯æ´
        document.getElementById('searchInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') loadUsers();
        });

        // åˆå§‹è¼‰å…¥
        loadStats();
        loadUsers();
    </script>
</body>
</html>
