"""
台股名稱對照表
版本: 1.0.0
日期: 2026-01-12

解決 Yahoo Finance API 返回的台股名稱 UTF-8 編碼問題
"""

# 常見台股名稱對照表（正確 UTF-8 編碼）
TAIWAN_STOCK_NAMES = {
    # === ETF ===
    "0050": "元大台灣50",
    "0051": "元大中型100",
    "0052": "富邦科技",
    "0053": "元大電子",
    "0055": "元大MSCI金融",
    "0056": "元大高股息",
    "0057": "富邦摩台",
    "006205": "富邦上證",
    "006206": "元大上證50",
    "006208": "富邦台50",
    "00631L": "元大台灣50正2",
    "00632R": "元大台灣50反1",
    "00635U": "元大S&P黃金",
    "00636": "國泰中國A50",
    "00637L": "元大滬深300正2",
    "00639": "富邦深100",
    "00642U": "元大S&P石油",
    "00645": "富邦日本",
    "00646": "元大S&P500",
    "00647L": "元大S&P500正2",
    "00648R": "元大S&P500反1",
    "00650L": "復華香港正2",
    "00655L": "國泰中國A50正2",
    "00657": "國泰日經225",
    "00661": "元大日經225",
    "00662": "富邦NASDAQ",
    "00663L": "國泰臺灣加權正2",
    "00664R": "國泰臺灣加權反1",
    "00668": "國泰美國道瓊",
    "00669R": "國泰美國道瓊反1",
    "00670L": "富邦NASDAQ正2",
    "00675L": "富邦臺灣加權正2",
    "00676R": "富邦臺灣加權反1",
    "00677U": "富邦VIX",
    "00678": "群益NBI生技",
    "00680L": "元大美債20正2",
    "00681R": "元大美債20反1",
    "00682U": "元大美債20",
    "00683L": "元大美債反1",
    "00685L": "群益臺灣加權正2",
    "00686R": "群益臺灣加權反1",
    "00688L": "國泰20年美債正2",
    "00689R": "國泰20年美債反1",
    "00690": "兆豐藍籌30",
    "00692": "富邦公司治理",
    "00693U": "街口S&P黃金",
    "00696": "富邦遊戲娛樂",
    "00700": "富邦新興國企",
    "00701": "國泰股利精選30",
    "00703": "台新MSCI中國",
    "00706L": "元大美元指數正2",
    "00707R": "元大美元指數反1",
    "00708L": "元大歐洲50正2",
    "00709": "富邦歐洲",
    "00713": "元大台灣高息低波",
    "00714": "群益道瓊美國地產",
    "00715L": "街口投信布蘭特正2",
    "00717": "富邦美國特別股",
    "00730": "富邦臺灣優質高息",
    "00731": "復華富時高息低波",
    "00733": "富邦臺灣中小",
    "00735": "國泰臺韓科技",
    "00736": "國泰新興市場",
    "00737": "國泰AI+Robo",
    "00738U": "元大道瓊白銀",
    "00739": "元大MSCI A股",
    "00752": "中信中國高股息",
    "00753L": "中信中國50正2",
    "00757": "統一FANG+",
    "00762": "元大全球AI",
    "00763U": "街口道瓊銅",
    "00770": "國泰北美科技",
    "00771": "元大US高息特別股",
    "00850": "元大臺灣ESG永續",
    "00851": "台新全球AI",
    "00852L": "國泰美國費半正2",
    "00853": "統一MSCI韓國",
    "00861": "元大全球未來關鍵科技",
    "00865B": "國泰US短期公債",
    "00875": "國泰網路資安",
    "00876": "元大全球5G",
    "00878": "國泰永續高股息",
    "00881": "國泰台灣5G+",
    "00882": "中信中國高股息",
    "00885": "富邦越南",
    "00886": "元大全球雲端服務",
    "00887": "永豐台灣ESG",
    "00888": "永豐美國費半",
    "00889": "永豐台灣智能車",
    "00891": "中信關鍵半導體",
    "00892": "富邦台灣半導體",
    "00893": "國泰智能電動車",
    "00894": "中信台資高價30",
    "00895": "富邦未來車",
    "00896": "中信綠能電動車",
    "00897": "富邦基因免疫生技",
    "00898": "國泰基因免疫革命",
    "00899": "富邦美債20年",
    "00900": "富邦特選高股息30",
    "00901": "永豐智能車供應鏈",
    "00902": "中信電池及儲能",
    "00903": "富邦元宇宙",
    "00904": "新光臺灣半導體30",
    "00905": "FT臺灣Smart",
    "00907": "永豐優息存股",
    "00908": "富邦入息REITs+",
    "00909": "國泰數位支付服務",
    "00910": "第一金太空衛星",
    "00911": "兆豐洲際半導體",
    "00912": "中信臺灣智慧50",
    "00913": "兆豐台灣晶圓製造",
    "00915": "凱基優選高股息30",
    "00916": "國泰全球品牌50",
    "00917": "中信特選金融",
    "00918": "大華優利高填息30",
    "00919": "群益台灣精選高息",
    "00920": "富邦全球非投等債",
    "00921": "兆豐龍頭等權重",
    "00922": "國泰台灣領袖50",
    "00923": "群益半導體收益",
    "00926": "凱基半導體",
    "00927": "群益半導體收益",
    "00928": "中信上櫃ESG30",
    "00929": "復華台灣科技優息",
    "00930": "永豐ESG低碳高息",
    "00931": "統一台灣高息動能",
    "00932": "兆豐永續高息等權",
    "00933": "國泰10Y+金融債",
    "00934": "中信成長高股息",
    "00935": "野村台灣新科技50",
    "00936": "台新臺灣IC設計",
    "00939": "統一台灣高息優選",
    "00940": "元大台灣價值高息",
    
    # === 常見個股 ===
    "1101": "台泥",
    "1102": "亞泥",
    "1216": "統一",
    "1301": "台塑",
    "1303": "南亞",
    "1326": "台化",
    "1402": "遠東新",
    "1476": "儒鴻",
    "2002": "中鋼",
    "2105": "正新",
    "2207": "和泰車",
    "2227": "裕日車",
    "2301": "光寶科",
    "2303": "聯電",
    "2308": "台達電",
    "2317": "鴻海",
    "2324": "仁寶",
    "2327": "國巨",
    "2330": "台積電",
    "2337": "旺宏",
    "2344": "華邦電",
    "2345": "智邦",
    "2351": "順德",
    "2353": "宏碁",
    "2354": "鴻準",
    "2356": "英業達",
    "2357": "華碩",
    "2360": "致茂",
    "2376": "技嘉",
    "2377": "微星",
    "2379": "瑞昱",
    "2382": "廣達",
    "2383": "台光電",
    "2385": "群光",
    "2388": "威盛",
    "2392": "正崴",
    "2395": "研華",
    "2401": "凌陽",
    "2402": "毅嘉",
    "2408": "南亞科",
    "2409": "友達",
    "2412": "中華電",
    "2454": "聯發科",
    "2474": "可成",
    "2492": "華新科",
    "2498": "宏達電",
    "2603": "長榮",
    "2609": "陽明",
    "2610": "華航",
    "2615": "萬海",
    "2618": "長榮航",
    "2633": "台灣高鐵",
    "2801": "彰銀",
    "2809": "京城銀",
    "2812": "台中銀",
    "2816": "旺旺保",
    "2823": "中壽",
    "2834": "臺企銀",
    "2838": "聯邦銀",
    "2845": "遠東銀",
    "2867": "三商壽",
    "2880": "華南金",
    "2881": "富邦金",
    "2882": "國泰金",
    "2883": "開發金",
    "2884": "玉山金",
    "2885": "元大金",
    "2886": "兆豐金",
    "2887": "台新金",
    "2888": "新光金",
    "2889": "國票金",
    "2890": "永豐金",
    "2891": "中信金",
    "2892": "第一金",
    "2903": "遠百",
    "2912": "統一超",
    "3008": "大立光",
    "3017": "奇鋐",
    "3034": "聯詠",
    "3037": "欣興",
    "3044": "健鼎",
    "3045": "台灣大",
    "3231": "緯創",
    "3443": "創意",
    "3481": "群創",
    "3533": "嘉澤",
    "3661": "世芯-KY",
    "3665": "貿聯-KY",
    "3711": "日月光投控",
    "4904": "遠傳",
    "4938": "和碩",
    "5269": "祥碩",
    "5347": "世界",
    "5871": "中租-KY",
    "5876": "上海商銀",
    "5880": "合庫金",
    "6005": "群益證",
    "6116": "彩晶",
    "6176": "瑞儀",
    "6239": "力成",
    "6269": "台郡",
    "6285": "啟碁",
    "6409": "旭隼",
    "6415": "矽力-KY",
    "6446": "藥華藥",
    "6488": "環球晶",
    "6505": "台塑化",
    "6515": "穎崴",
    "6531": "愛普",
    "6533": "晶心科",
    "6547": "高端疫苗",
    "6552": "易華電",
    "6558": "興能高",
    "6669": "緯穎",
    "6670": "復盛應用",
    "6789": "采鈺",
    "8046": "南電",
    "8454": "富邦媒",
    "9910": "豐泰",
    "9921": "巨大",
    "9941": "裕融",
    "9945": "潤泰新",
}


def get_taiwan_stock_name(symbol: str) -> str:
    """
    取得台股名稱
    
    Args:
        symbol: 股票代碼 (例如 "2330" 或 "2330.TW")
    
    Returns:
        股票名稱，若找不到則返回代碼本身
    """
    stock_code = symbol.replace('.TW', '').replace('.TWO', '').strip()
    return TAIWAN_STOCK_NAMES.get(stock_code, symbol)


def is_taiwan_stock(symbol: str) -> bool:
    """判斷是否為台股"""
    symbol = symbol.upper().strip()
    
    if symbol.endswith('.TW') or symbol.endswith('.TWO'):
        return True
    
    if symbol.isdigit() and 4 <= len(symbol) <= 6:
        return True
    
    return False
